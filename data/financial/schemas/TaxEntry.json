{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "TaxEntry",
  "description": "Tax calculation entry for a specific line item or document. References a Tax definition and calculates the actual tax amount applied. Used in CommercialDocument.taxDetails[].",
  "properties": [
    {
      "name": "tax",
      "type": "Tax",
      "mode": "stored",
      "description": "Reference to the Tax entity (contains code, name, type, rate, jurisdiction)",
      "required": true
    },
    {
      "name": "taxableAmount",
      "type": "MonetaryAmount",
      "mode": "stored",
      "description": "Amount subject to this tax (base for calculation)",
      "required": true
    },
    {
      "name": "taxAmount",
      "type": "MonetaryAmount",
      "mode": "computed",
      "description": "Calculated tax amount (taxableAmount * tax.rate / 100 or per tax.calculationMethod)"
    },
    {
      "name": "appliedRate",
      "type": "number",
      "mode": "stored",
      "description": "Actual rate applied (may differ from tax.rate due to exemptions or overrides)",
      "example": 20
    },
    {
      "name": "isExempt",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether this line is tax exempt (overrides normal tax application)",
      "example": false
    },
    {
      "name": "exemptionReason",
      "type": "string",
      "mode": "stored",
      "description": "Reason for tax exemption if isExempt is true",
      "example": "Essential goods exemption"
    }
  ],
  "examples": [
    {
      "@type": "TaxEntry",
      "tax": {
        "@type": "Tax",
        "code": "VAT-STD-20",
        "name": "VAT Standard Rate",
        "taxType": "vat",
        "rate": 20,
        "jurisdiction": "FR"
      },
      "taxableAmount": {
        "@type": "MonetaryAmount",
        "value": 1000.00,
        "currency": {
          "@type": "Currency",
          "code": "EUR",
          "symbol": "€"
        }
      },
      "taxAmount": {
        "@type": "MonetaryAmount",
        "value": 200.00,
        "currency": {
          "@type": "Currency",
          "code": "EUR",
          "symbol": "€"
        }
      },
      "appliedRate": 20,
      "isExempt": false
    },
    {
      "@type": "TaxEntry",
      "tax": {
        "@type": "Tax",
        "code": "NY-SALES-8.875",
        "name": "New York Sales Tax",
        "taxType": "sales_tax",
        "rate": 8.875,
        "jurisdiction": "NY"
      },
      "taxableAmount": {
        "@type": "MonetaryAmount",
        "value": 500.00,
        "currency": {
          "@type": "Currency",
          "code": "USD",
          "symbol": "$"
        }
      },
      "taxAmount": {
        "@type": "MonetaryAmount",
        "value": 44.38,
        "currency": {
          "@type": "Currency",
          "code": "USD",
          "symbol": "$"
        }
      },
      "appliedRate": 8.875,
      "isExempt": false
    },
    {
      "@type": "TaxEntry",
      "tax": {
        "@type": "Tax",
        "code": "VAT-RED-5.5",
        "name": "VAT Reduced Rate",
        "taxType": "vat",
        "rate": 5.5,
        "jurisdiction": "FR"
      },
      "taxableAmount": {
        "@type": "MonetaryAmount",
        "value": 100.00,
        "currency": {
          "@type": "Currency",
          "code": "EUR",
          "symbol": "€"
        }
      },
      "taxAmount": {
        "@type": "MonetaryAmount",
        "value": 0.00,
        "currency": {
          "@type": "Currency",
          "code": "EUR",
          "symbol": "€"
        }
      },
      "appliedRate": 0,
      "isExempt": true,
      "exemptionReason": "Essential food product - exempt from VAT"
    }
  ]
}

