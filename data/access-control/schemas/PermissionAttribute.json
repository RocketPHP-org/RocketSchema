{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "PermissionAttribute",
  "description": "Defines metadata and properties associated with permissions that influence their behavior, evaluation, and management within the access control system. Permission attributes are key-value pairs that enrich permissions with additional context beyond simple grant/deny - they specify quality of service parameters, risk indicators, compliance tags, and operational constraints. These attributes enable fine-tuning of permission behavior: setting expiration dates, defining usage quotas, specifying required authentication strength, or marking permissions as high-risk. Attributes support permission classification for governance (marking permissions as 'financial', 'personal_data', 'system_critical'), automated policy application (all 'financial' permissions require MFA), and compliance mapping (permissions tagged 'gdpr_relevant' need special handling). They enable permission lifecycle management with attributes like 'deprecated', 'experimental', or 'migration_required'. The entity handles inherited attributes from parent permissions, computed attributes derived from usage patterns, and dynamic attributes that change based on context. Attributes influence runtime behavior - a permission with 'require_justification' attribute prompts users for reasons, while 'notify_on_use' triggers alerts. This metadata layer transforms simple permissions into rich, self-describing capabilities that adapt to organizational needs, support automated governance, and enable sophisticated permission analytics.",
  "properties": [
    {
      "name": "permission",
      "type": "Permission",
      "mode": "stored",
      "description": "Permission this attribute belongs to",
      "required": true
    },
    {
      "name": "attributeName",
      "type": "string",
      "mode": "stored",
      "description": "Name of the attribute",
      "required": true,
      "example": "risk_level"
    },
    {
      "name": "attributeValue",
      "type": "string",
      "mode": "stored",
      "description": "Value of the attribute",
      "required": true,
      "example": "high"
    },
    {
      "name": "valueType",
      "type": "string",
      "mode": "enum",
      "description": "Data type of the attribute value",
      "enum": [
        "string",
        "number",
        "boolean",
        "date",
        "json",
        "array"
      ],
      "required": true
    },
    {
      "name": "category",
      "type": "string",
      "mode": "enum",
      "description": "Category of attribute",
      "enum": [
        "security",
        "compliance",
        "operational",
        "lifecycle",
        "quality",
        "behavioral",
        "custom"
      ],
      "required": true
    },
    {
      "name": "description",
      "type": "string",
      "mode": "stored",
      "description": "Explanation of what this attribute represents",
      "example": "Indicates the risk level associated with using this permission"
    },
    {
      "name": "isInherited",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether inherited from parent permission",
      "default": false
    },
    {
      "name": "inheritedFrom",
      "type": "Permission",
      "mode": "stored",
      "description": "Parent permission this was inherited from",
      "nullable": true
    },
    {
      "name": "isComputed",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether this is a calculated attribute",
      "default": false
    },
    {
      "name": "computeExpression",
      "type": "string",
      "mode": "stored",
      "description": "Expression to compute attribute value",
      "nullable": true,
      "example": "usage_count > 100 ? 'frequently_used' : 'rarely_used'"
    },
    {
      "name": "isDynamic",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether value changes based on context",
      "default": false
    },
    {
      "name": "updateFrequency",
      "type": "string",
      "mode": "stored",
      "description": "How often dynamic attributes update",
      "nullable": true,
      "example": "hourly"
    },
    {
      "name": "validationRules",
      "type": "string",
      "mode": "stored",
      "description": "JSON rules for validating attribute values",
      "nullable": true,
      "example": "{\"enum\":[\"low\",\"medium\",\"high\",\"critical\"],\"required\":true}"
    },
    {
      "name": "defaultValue",
      "type": "string",
      "mode": "stored",
      "description": "Default value if not specified",
      "nullable": true
    },
    {
      "name": "allowedValues",
      "type": "string",
      "mode": "stored",
      "description": "JSON array of permitted values",
      "nullable": true,
      "example": "[\"low\",\"medium\",\"high\",\"critical\"]"
    },
    {
      "name": "impactOnBehavior",
      "type": "string",
      "mode": "stored",
      "description": "How this attribute affects permission behavior",
      "nullable": true,
      "example": "Triggers additional authentication when risk_level is high"
    },
    {
      "name": "visibility",
      "type": "string",
      "mode": "enum",
      "description": "Who can see this attribute",
      "enum": [
        "public",
        "admin",
        "system",
        "hidden"
      ],
      "default": "admin"
    },
    {
      "name": "modifiable",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether attribute can be modified",
      "default": true
    },
    {
      "name": "propagateToChildren",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether child permissions inherit this",
      "default": false
    },
    {
      "name": "priority",
      "type": "integer",
      "mode": "stored",
      "description": "Priority when attributes conflict",
      "default": 0
    },
    {
      "name": "tags",
      "type": "string",
      "mode": "stored",
      "description": "JSON array of tags for categorization",
      "nullable": true
    },
    {
      "name": "auditChanges",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether to audit attribute changes",
      "default": true
    },
    {
      "name": "effectiveFrom",
      "type": "DateTime",
      "mode": "stored",
      "description": "When attribute becomes effective",
      "nullable": true
    },
    {
      "name": "effectiveUntil",
      "type": "DateTime",
      "mode": "stored",
      "description": "When attribute expires",
      "nullable": true
    },
    {
      "name": "isActive",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether attribute is currently active",
      "default": true
    },
    {
      "name": "metadata",
      "type": "string",
      "mode": "stored",
      "description": "Additional attribute configuration"
    }
  ],
  "examples": [
    {
      "@type": "PermissionAttribute",
      "attributeName": "risk_level",
      "attributeValue": "critical",
      "valueType": "string",
      "category": "security",
      "description": "Indicates this permission can cause irreversible data loss",
      "isInherited": false,
      "isComputed": false,
      "isDynamic": false,
      "validationRules": "{\"enum\":[\"low\",\"medium\",\"high\",\"critical\"],\"required\":true}",
      "defaultValue": "medium",
      "allowedValues": "[\"low\",\"medium\",\"high\",\"critical\"]",
      "impactOnBehavior": "Requires additional confirmation and MFA when risk_level is critical",
      "visibility": "admin",
      "modifiable": false,
      "propagateToChildren": true,
      "priority": 100,
      "tags": "[\"dangerous\",\"audit_required\",\"approval_needed\"]",
      "auditChanges": true,
      "isActive": true,
      "metadata": {
        "compliance_impact": "high",
        "require_justification": true
      },
      "permission": "perm_delete_user"
    },
    {
      "@type": "PermissionAttribute",
      "attributeName": "usage_quota",
      "attributeValue": "100",
      "valueType": "number",
      "category": "operational",
      "description": "Maximum number of exports allowed per month",
      "isInherited": false,
      "isComputed": false,
      "isDynamic": true,
      "updateFrequency": "monthly",
      "validationRules": "{\"min\":0,\"max\":1000,\"type\":\"integer\"}",
      "defaultValue": "50",
      "impactOnBehavior": "Blocks permission usage when quota is exceeded",
      "visibility": "public",
      "modifiable": true,
      "propagateToChildren": false,
      "priority": 50,
      "auditChanges": true,
      "isActive": true,
      "metadata": {
        "reset_period": "monthly",
        "quota_type": "rolling",
        "alert_threshold": 0.8
      },
      "permission": "perm_export_data"
    }
  ]
}