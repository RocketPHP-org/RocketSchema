{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "AccessContext",
  "description": "Captures the complete environmental and situational context in which an access request occurs, providing crucial information for context-aware authorization decisions. This entity represents the 'circumstances' of access - not just who wants what, but when, where, how, and under what conditions. It includes technical context (IP address, device, browser), temporal context (time of day, day of week, timezone), geographic context (location, jurisdiction), behavioral context (access patterns, risk indicators), and business context (project phase, emergency status). Modern zero-trust architectures use this rich context to make dynamic authorization decisions - the same user might be granted access from the office during business hours but denied from an unknown location at midnight. The context enables adaptive security where access requirements change based on threat level, implements conditional access policies ('require MFA from untrusted networks'), and supports compliance requirements ('EU data only accessible from EU locations'). It captures session information, authentication strength, device trust level, and network security posture. The entity also tracks anomalies and risk signals that might indicate compromised credentials or insider threats. This contextual awareness transforms static permission checks into dynamic, risk-based access decisions that adapt to changing security landscapes and business needs.",
  "properties": [
    {
      "name": "session",
      "type": "Session",
      "mode": "stored",
      "description": "Associated user session",
      "required": true
    },
    {
      "name": "user",
      "type": "User",
      "mode": "stored",
      "description": "User making the access request",
      "required": true
    },
    {
      "name": "timestamp",
      "type": "DateTime",
      "mode": "stored",
      "description": "When the access context was captured",
      "required": true
    },
    {
      "name": "ipAddress",
      "type": "string",
      "mode": "stored",
      "description": "Source IP address",
      "required": true
    },
    {
      "name": "ipReputation",
      "type": "string",
      "mode": "stored",
      "description": "IP reputation score and category",
      "example": "{\"score\":85,\"category\":\"corporate\",\"threat_level\":\"low\"}"
    },
    {
      "name": "location",
      "type": "string",
      "mode": "stored",
      "description": "Geographic location data",
      "example": "{\"country\":\"US\",\"region\":\"California\",\"city\":\"San Francisco\",\"coordinates\":{\"lat\":37.7749,\"lng\":-122.4194}}"
    },
    {
      "name": "deviceId",
      "type": "string",
      "mode": "stored",
      "description": "Unique device identifier",
      "nullable": true
    },
    {
      "name": "deviceInfo",
      "type": "string",
      "mode": "stored",
      "description": "JSON device characteristics",
      "example": "{\"type\":\"laptop\",\"os\":\"macOS 14.2\",\"browser\":\"Chrome 120\",\"managed\":true,\"compliant\":true}"
    },
    {
      "name": "deviceTrustLevel",
      "type": "integer",
      "mode": "stored",
      "description": "Device trust score (0-100)",
      "min": 0,
      "max": 100
    },
    {
      "name": "authenticationMethod",
      "type": "string",
      "mode": "stored",
      "description": "How user authenticated",
      "example": "mfa_biometric"
    },
    {
      "name": "authenticationStrength",
      "type": "string",
      "mode": "enum",
      "description": "Strength of authentication",
      "enum": [
        "none",
        "weak",
        "medium",
        "strong",
        "very_strong"
      ],
      "required": true
    },
    {
      "name": "mfaVerified",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether MFA was completed",
      "default": false
    },
    {
      "name": "networkType",
      "type": "string",
      "mode": "enum",
      "description": "Type of network connection",
      "enum": [
        "corporate",
        "vpn",
        "public",
        "home",
        "mobile",
        "unknown"
      ],
      "required": true
    },
    {
      "name": "networkSecurity",
      "type": "string",
      "mode": "stored",
      "description": "Network security assessment",
      "example": "{\"encrypted\":true,\"vpn\":true,\"firewall\":\"enabled\",\"proxy\":false}"
    },
    {
      "name": "timeOfDay",
      "type": "string",
      "mode": "stored",
      "description": "Time category",
      "example": "business_hours"
    },
    {
      "name": "dayOfWeek",
      "type": "string",
      "mode": "stored",
      "description": "Day of the week",
      "example": "monday"
    },
    {
      "name": "timezone",
      "type": "string",
      "mode": "stored",
      "description": "User's timezone",
      "example": "America/New_York"
    },
    {
      "name": "behaviorAnalysis",
      "type": "string",
      "mode": "stored",
      "description": "JSON behavioral indicators",
      "example": "{\"typical_location\":true,\"typical_time\":false,\"access_velocity\":\"normal\",\"pattern_match\":0.87}"
    },
    {
      "name": "riskScore",
      "type": "integer",
      "mode": "stored",
      "description": "Calculated risk score (0-100)",
      "min": 0,
      "max": 100,
      "nullable": true
    },
    {
      "name": "riskFactors",
      "type": "string",
      "mode": "stored",
      "description": "JSON array of identified risks",
      "example": "[\"new_device\",\"unusual_time\",\"sensitive_operation\"]"
    },
    {
      "name": "threatIntelligence",
      "type": "string",
      "mode": "stored",
      "description": "External threat data",
      "nullable": true,
      "example": "{\"ip_blocklist\":false,\"known_attacker\":false,\"threat_campaign\":null}"
    },
    {
      "name": "requestPath",
      "type": "string",
      "mode": "stored",
      "description": "Application path or API endpoint",
      "example": "/api/v1/financial/transactions"
    },
    {
      "name": "requestMethod",
      "type": "string",
      "mode": "stored",
      "description": "HTTP method or operation type",
      "example": "POST"
    },
    {
      "name": "userAgent",
      "type": "string",
      "mode": "stored",
      "description": "Browser/application user agent"
    },
    {
      "name": "referrer",
      "type": "string",
      "mode": "stored",
      "description": "HTTP referrer if applicable",
      "nullable": true
    },
    {
      "name": "businessContext",
      "type": "string",
      "mode": "stored",
      "description": "Business situation data",
      "nullable": true,
      "example": "{\"project_phase\":\"production\",\"change_freeze\":false,\"audit_mode\":true}"
    },
    {
      "name": "environmentType",
      "type": "string",
      "mode": "enum",
      "description": "System environment",
      "enum": [
        "development",
        "testing",
        "staging",
        "production"
      ],
      "required": true
    },
    {
      "name": "emergencyAccess",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether emergency access was requested",
      "default": false
    },
    {
      "name": "parentContextId",
      "type": "uuid",
      "mode": "stored",
      "description": "Previous context in session chain",
      "nullable": true
    },
    {
      "name": "metadata",
      "type": "object",
      "mode": "stored",
      "description": "Additional context data"
    }
  ],
  "examples": [
    {
      "@type": "AccessContext",
      "timestamp": "2024-03-15T14:30:00Z",
      "ipAddress": "203.0.113.42",
      "ipReputation": "{\"score\":95,\"category\":\"corporate\",\"threat_level\":\"low\",\"asn\":\"AS12345\"}",
      "location": "{\"country\":\"US\",\"region\":\"California\",\"city\":\"San Francisco\",\"coordinates\":{\"lat\":37.7749,\"lng\":-122.4194},\"accuracy\":\"city\"}",
      "deviceId": "device_laptop_001",
      "deviceInfo": "{\"type\":\"laptop\",\"os\":\"Windows 11\",\"browser\":\"Edge 120\",\"managed\":true,\"compliant\":true,\"patch_level\":\"current\"}",
      "deviceTrustLevel": 90,
      "authenticationMethod": "passwordless_biometric",
      "authenticationStrength": "very_strong",
      "mfaVerified": true,
      "networkType": "corporate",
      "networkSecurity": "{\"encrypted\":true,\"vpn\":false,\"firewall\":\"enabled\",\"nac\":\"passed\"}",
      "timeOfDay": "business_hours",
      "dayOfWeek": "wednesday",
      "timezone": "America/Los_Angeles",
      "behaviorAnalysis": "{\"typical_location\":true,\"typical_time\":true,\"access_velocity\":\"normal\",\"pattern_match\":0.94,\"anomaly_score\":5}",
      "riskScore": 15,
      "riskFactors": "[]",
      "requestPath": "/api/v1/reports/financial",
      "requestMethod": "GET",
      "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
      "businessContext": "{\"quarter_end\":false,\"audit_period\":false,\"normal_operations\":true}",
      "environmentType": "production",
      "emergencyAccess": false,
      "metadata": {
        "session_age_minutes": 45,
        "requests_in_session": 23
      },
      "user": "user_john_doe",
      "session": "sess_xyz789"
    },
    {
      "@type": "AccessContext",
      "timestamp": "2024-03-15T02:45:00Z",
      "ipAddress": "198.51.100.99",
      "ipReputation": "{\"score\":45,\"category\":\"vpn_exit\",\"threat_level\":\"medium\",\"anonymous_proxy\":true}",
      "location": "{\"country\":\"RO\",\"region\":\"Bucharest\",\"city\":\"Bucharest\",\"vpn_detected\":true}",
      "deviceId": null,
      "deviceInfo": "{\"type\":\"unknown\",\"os\":\"Linux\",\"browser\":\"Firefox 115\",\"managed\":false,\"compliant\":false}",
      "deviceTrustLevel": 20,
      "authenticationMethod": "password_only",
      "authenticationStrength": "weak",
      "mfaVerified": false,
      "networkType": "public",
      "networkSecurity": "{\"encrypted\":true,\"vpn\":true,\"firewall\":\"unknown\",\"tor_exit\":false}",
      "timeOfDay": "after_hours",
      "dayOfWeek": "saturday",
      "timezone": "Europe/Bucharest",
      "behaviorAnalysis": "{\"typical_location\":false,\"typical_time\":false,\"access_velocity\":\"high\",\"pattern_match\":0.23,\"anomaly_score\":78}",
      "riskScore": 85,
      "riskFactors": "[\"new_device\",\"unusual_location\",\"vpn_usage\",\"after_hours\",\"weak_auth\",\"high_velocity\"]",
      "threatIntelligence": "{\"ip_blocklist\":false,\"known_attacker\":false,\"suspicious_asn\":true}",
      "requestPath": "/api/v1/data/export",
      "requestMethod": "POST",
      "userAgent": "Mozilla/5.0 (X11; Linux x86_64) Firefox/115.0",
      "businessContext": "{\"contractor_active\":true,\"contract_expires\":\"2024-04-01\"}",
      "environmentType": "production",
      "emergencyAccess": false,
      "metadata": {
        "alert_triggered": true,
        "security_review_required": true
      },
      "user": "user_contractor",
      "session": "sess_suspicious_001"
    }
  ]
}