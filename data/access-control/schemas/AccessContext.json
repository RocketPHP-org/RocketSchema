{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "AccessContext",
  "description": "Contextual information for ABAC evaluation including environment and request details",
  "properties": [
    {
      "name": "contextId",
      "type": "string",
      "mode": "stored",
      "description": "Unique context identifier",
      "required": true,
      "unique": true
    },
    {
      "name": "requestor",
      "type": "User",
      "mode": "stored",
      "description": "User making the request",
      "required": true
    },
    {
      "name": "requestTime",
      "type": "DateTime",
      "mode": "stored",
      "description": "Time of the request",
      "required": true
    },
    {
      "name": "resource",
      "type": "object",
      "mode": "stored",
      "description": "Resource being accessed",
      "required": true,
      "example": {
        "type": "document",
        "id": "doc_123",
        "owner": "user_456",
        "classification": "confidential",
        "department": "finance"
      }
    },
    {
      "name": "action",
      "type": "string",
      "mode": "stored",
      "description": "Action being performed",
      "required": true,
      "example": "read"
    },
    {
      "name": "environment",
      "type": "object",
      "mode": "stored",
      "description": "Environmental context",
      "example": {
        "ipAddress": "192.168.1.100",
        "location": {
          "country": "US",
          "region": "CA",
          "city": "San Francisco"
        },
        "network": "corporate",
        "deviceType": "laptop",
        "deviceId": "device_789",
        "deviceTrust": "managed"
      }
    },
    {
      "name": "session",
      "type": "object",
      "mode": "stored",
      "description": "Session information",
      "example": {
        "sessionId": "sess_abc",
        "authMethod": "mfa",
        "authTime": "2024-03-15T08:00:00Z",
        "sessionAge": 3600,
        "idleTime": 300
      }
    },
    {
      "name": "subjectAttributes",
      "type": "object",
      "mode": "stored",
      "description": "Additional subject attributes for evaluation",
      "example": {
        "department": "engineering",
        "clearanceLevel": 3,
        "employmentType": "full_time",
        "yearsOfService": 5,
        "certifications": ["security_cleared", "data_handler"]
      }
    },
    {
      "name": "resourceAttributes",
      "type": "object",
      "mode": "stored",
      "description": "Additional resource attributes",
      "example": {
        "createdDate": "2024-01-01",
        "lastModified": "2024-03-01",
        "size": 1024000,
        "tags": ["financial", "q1_2024"],
        "encryption": "AES256"
      }
    },
    {
      "name": "requestAttributes",
      "type": "object",
      "mode": "stored",
      "description": "Request-specific attributes",
      "example": {
        "purpose": "audit",
        "projectId": "proj_123",
        "ticketId": "ticket_456",
        "delegatedBy": "user_789"
      }
    },
    {
      "name": "riskIndicators",
      "type": "object",
      "mode": "stored",
      "description": "Risk-related indicators",
      "example": {
        "riskScore": 35,
        "anomalyScore": 0.2,
        "threatLevel": "low",
        "suspiciousPatterns": [],
        "recentFailures": 0
      }
    },
    {
      "name": "obligations",
      "type": "object[]",
      "mode": "stored",
      "description": "Obligations to be fulfilled",
      "example": [
        {
          "type": "audit",
          "level": "detailed"
        },
        {
          "type": "notification",
          "target": "data_owner"
        }
      ]
    },
    {
      "name": "parentContext",
      "type": "AccessContext",
      "mode": "stored",
      "description": "Parent context for nested requests"
    },
    {
      "name": "delegationChain",
      "type": "object[]",
      "mode": "stored",
      "description": "Chain of delegation if access is delegated",
      "example": [
        {
          "delegator": "user_100",
          "delegatee": "user_200",
          "permissions": ["read"],
          "validUntil": "2024-03-20T00:00:00Z"
        }
      ]
    },
    {
      "name": "evaluationResult",
      "type": "object",
      "mode": "stored",
      "description": "Result of access evaluation",
      "example": {
        "decision": "permit",
        "appliedPolicies": ["policy_1", "policy_2"],
        "matchedRules": ["rule_1", "rule_3"],
        "obligations": ["audit", "encrypt"],
        "confidence": 0.95
      }
    },
    {
      "name": "metadata",
      "type": "object",
      "mode": "stored",
      "description": "Additional metadata"
    }
  ],
  "examples": [
    {
      "@type": "AccessContext",
      "contextId": "ctx_xyz789",
      "requestTime": "2024-03-15T10:30:00Z",
      "resource": {
        "type": "document",
        "id": "doc_financial_q1",
        "classification": "confidential",
        "department": "finance"
      },
      "action": "read",
      "environment": {
        "ipAddress": "10.0.1.50",
        "location": {
          "country": "US",
          "region": "NY"
        },
        "network": "corporate",
        "deviceType": "laptop",
        "deviceTrust": "managed"
      },
      "session": {
        "sessionId": "sess_morning_123",
        "authMethod": "mfa",
        "authTime": "2024-03-15T08:00:00Z",
        "sessionAge": 9000
      },
      "subjectAttributes": {
        "department": "finance",
        "clearanceLevel": 3,
        "employmentType": "full_time"
      },
      "riskIndicators": {
        "riskScore": 15,
        "threatLevel": "low"
      }
    }
  ]
}
