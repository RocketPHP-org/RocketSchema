{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "TrustedDevice",
  "description": "Represents a device that has been designated as trusted for authentication purposes, allowing users to bypass additional verification steps on recognized devices. When a user successfully authenticates from a device, they can designate it as trusted, creating a trust relationship that persists across sessions. This improves user experience by reducing authentication friction on frequently-used devices while maintaining security on unrecognized devices. Each device is identified through a unique fingerprint derived from device characteristics, making it difficult to impersonate trusted devices. Trust relationships can be time-limited with automatic expiration, or manually revoked by users or security systems when suspicious activity is detected. Users typically manage their trusted devices through security settings, monitoring which devices have access and when they were last verified. This pattern balances security requirements with usability, commonly seen in banking systems, enterprise applications, and consumer platforms that remember authorized devices while requiring additional verification from new ones.",
  "properties": [
    {
      "name": "principal",
      "type": "SecurityPrincipal",
      "mode": "stored",
      "description": "The security principal (user, service account, or system) that has established trust with this device",
      "required": true
    },
    {
      "name": "label",
      "type": "string",
      "mode": "stored",
      "description": "Human-readable label assigned to this device for easy identification in device management interfaces",
      "required": true,
      "example": "Office Workstation"
    },
    {
      "name": "category",
      "type": "string",
      "mode": "enum",
      "description": "Classification of the device form factor, used for display purposes and potential policy application",
      "enum": [
        "desktop",
        "laptop",
        "mobile",
        "tablet",
        "browser",
        "terminal",
        "kiosk",
        "embedded"
      ],
      "required": true
    },
    {
      "name": "fingerprint",
      "type": "string",
      "mode": "stored",
      "description": "Cryptographic or composite identifier uniquely representing this device based on multiple immutable or semi-permanent characteristics, used as the primary mechanism for device recognition across sessions",
      "required": true,
      "unique": true,
      "private": true
    },
    {
      "name": "characteristics",
      "type": "JSON",
      "mode": "stored",
      "description": "Structured collection of device attributes captured during trust establishment, such as platform type, client version, hardware identifiers, and capability flags, stored for audit and verification purposes",
      "nullable": true
    },
    {
      "name": "establishedAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "Timestamp when the trust relationship was initially created and the device was first designated as trusted",
      "required": true
    },
    {
      "name": "expiresAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "Timestamp when the trust relationship automatically expires and the device will no longer be recognized as trusted, null indicates permanent trust subject to manual revocation only",
      "nullable": true
    },
    {
      "name": "revokedAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "Timestamp when the trust relationship was explicitly revoked, either by user action, administrative intervention, or automated security policy",
      "nullable": true
    },
    {
      "name": "revocationCategory",
      "type": "string",
      "mode": "enum",
      "description": "Classification of why the trust relationship was terminated, providing context for security auditing and user notification",
      "enum": [
        "user_initiated",
        "device_lost",
        "device_stolen",
        "device_compromised",
        "security_policy",
        "suspicious_activity",
        "account_closure",
        "expired_unused",
        "administrative"
      ],
      "nullable": true
    },
    {
      "name": "riskLevel",
      "type": "integer",
      "mode": "computed",
      "description": "Numerical assessment of security risk associated with this device based on usage patterns, verification history, and behavioral analysis, ranging from 0 (lowest risk) to 100 (highest risk)",
      "min": 0,
      "max": 100,
      "nullable": true
    },
    {
      "name": "isCurrentlyTrusted",
      "type": "boolean",
      "mode": "computed",
      "description": "Indicates whether the device trust is currently valid, derived from revocation status, expiration time, and active security policies"
    },
    {
      "name": "lastVerificationAt",
      "type": "DateTime",
      "mode": "computed",
      "description": "Timestamp of the most recent successful verification event for this device, computed from authentication or verification activity logs"
    },
    {
      "name": "verificationCount",
      "type": "integer",
      "mode": "computed",
      "description": "Total number of times this device has been successfully verified or used for authentication, derived from activity event history"
    }
  ],
  "examples": [
    {
      "@type": "TrustedDevice",
      "principal": {
        "@type": "SecurityPrincipal",
        "identifier": "alice.johnson"
      },
      "label": "Primary Workstation",
      "category": "desktop",
      "fingerprint": "sha256:8f434346648f6b96df89dda901c5176b10a6d83961dd3c1ac88b59b2dc327aa4",
      "characteristics": {
        "platform": "desktop-unix",
        "clientType": "browser",
        "clientVersion": "122.0",
        "displayResolution": "2560x1440",
        "colorDepth": 24,
        "timezone": "America/New_York",
        "locale": "en-US"
      },
      "establishedAt": "2024-01-15T10:00:00Z",
      "expiresAt": "2024-04-15T10:00:00Z",
      "revokedAt": null,
      "revocationCategory": null,
      "riskLevel": 5,
      "isCurrentlyTrusted": true,
      "lastVerificationAt": "2024-03-15T08:30:00Z",
      "verificationCount": 145
    },
    {
      "@type": "TrustedDevice",
      "principal": {
        "@type": "SecurityPrincipal",
        "identifier": "bob.martinez"
      },
      "label": "Personal Mobile Device",
      "category": "mobile",
      "fingerprint": "sha256:2c26b46b68ffc68ff99b453c1d30413413422d706483bfa0f98a5e886266e7ae",
      "characteristics": {
        "platform": "mobile-ios",
        "clientType": "native_app",
        "clientVersion": "2.5.0",
        "deviceModel": "mobile-premium-2023",
        "biometricCapable": true,
        "secureEnclavePresent": true
      },
      "establishedAt": "2024-02-01T14:00:00Z",
      "expiresAt": null,
      "revokedAt": "2024-03-15T09:00:00Z",
      "revocationCategory": "device_lost",
      "riskLevel": 0,
      "isCurrentlyTrusted": false,
      "lastVerificationAt": "2024-03-14T19:45:00Z",
      "verificationCount": 89
    },
    {
      "@type": "TrustedDevice",
      "principal": {
        "@type": "SecurityPrincipal",
        "identifier": "automated-service-001"
      },
      "label": "Production API Client",
      "category": "terminal",
      "fingerprint": "sha256:5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8",
      "characteristics": {
        "platform": "server-linux",
        "clientType": "api_client",
        "clientVersion": "3.1.4",
        "certificateThumbprint": "a1b2c3d4e5f6",
        "ipAddressRange": "10.0.0.0/24"
      },
      "establishedAt": "2023-11-20T08:00:00Z",
      "expiresAt": null,
      "revokedAt": null,
      "revocationCategory": null,
      "riskLevel": 2,
      "isCurrentlyTrusted": true,
      "lastVerificationAt": "2024-03-16T12:00:00Z",
      "verificationCount": 12450
    }
  ]
}
