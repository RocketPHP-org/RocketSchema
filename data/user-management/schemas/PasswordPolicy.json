{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "PasswordPolicy",
  "description": "Password policy rules and requirements for an organization or system",
  "properties": [
    {
      "name": "name",
      "type": "string",
      "mode": "stored",
      "description": "Policy name",
      "required": true,
      "example": "Default Password Policy"
    },
    {
      "name": "code",
      "type": "string",
      "mode": "stored",
      "description": "Unique policy code",
      "required": true,
      "unique": true,
      "example": "DEFAULT"
    },
    {
      "name": "minLength",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum password length",
      "default": 8,
      "min": 1
    },
    {
      "name": "maxLength",
      "type": "integer",
      "mode": "stored",
      "description": "Maximum password length",
      "default": 128,
      "min": 1
    },
    {
      "name": "requireUppercase",
      "type": "boolean",
      "mode": "stored",
      "description": "Require at least one uppercase letter",
      "default": true
    },
    {
      "name": "requireLowercase",
      "type": "boolean",
      "mode": "stored",
      "description": "Require at least one lowercase letter",
      "default": true
    },
    {
      "name": "requireNumbers",
      "type": "boolean",
      "mode": "stored",
      "description": "Require at least one number",
      "default": true
    },
    {
      "name": "requireSpecialChars",
      "type": "boolean",
      "mode": "stored",
      "description": "Require at least one special character",
      "default": true
    },
    {
      "name": "specialChars",
      "type": "string",
      "mode": "stored",
      "description": "Allowed special characters",
      "default": "!@#$%^&*()_+-=[]{}|;:,.<>?"
    },
    {
      "name": "minUppercase",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum number of uppercase characters",
      "default": 1,
      "min": 0
    },
    {
      "name": "minLowercase",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum number of lowercase characters",
      "default": 1,
      "min": 0
    },
    {
      "name": "minNumbers",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum number of numeric characters",
      "default": 1,
      "min": 0
    },
    {
      "name": "minSpecialChars",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum number of special characters",
      "default": 1,
      "min": 0
    },
    {
      "name": "preventReuse",
      "type": "boolean",
      "mode": "stored",
      "description": "Prevent reuse of previous passwords",
      "default": true
    },
    {
      "name": "reusePreventionCount",
      "type": "integer",
      "mode": "stored",
      "description": "Number of previous passwords to check against",
      "default": 5,
      "min": 0
    },
    {
      "name": "expirationDays",
      "type": "integer",
      "mode": "stored",
      "description": "Password expiration in days (0 = never expires)",
      "default": 90,
      "min": 0
    },
    {
      "name": "warningDays",
      "type": "integer",
      "mode": "stored",
      "description": "Days before expiration to warn user",
      "default": 14,
      "min": 0
    },
    {
      "name": "preventCommonPasswords",
      "type": "boolean",
      "mode": "stored",
      "description": "Check against common password list",
      "default": true
    },
    {
      "name": "preventPersonalInfo",
      "type": "boolean",
      "mode": "stored",
      "description": "Prevent use of personal information in password",
      "default": true
    },
    {
      "name": "preventSequential",
      "type": "boolean",
      "mode": "stored",
      "description": "Prevent sequential characters (abc, 123)",
      "default": true
    },
    {
      "name": "preventRepeating",
      "type": "boolean",
      "mode": "stored",
      "description": "Prevent repeating characters (aaa, 111)",
      "default": true
    },
    {
      "name": "maxRepeatingChars",
      "type": "integer",
      "mode": "stored",
      "description": "Maximum consecutive repeating characters allowed",
      "default": 2,
      "min": 1
    },
    {
      "name": "lockoutAttempts",
      "type": "integer",
      "mode": "stored",
      "description": "Failed attempts before account lockout",
      "default": 5,
      "min": 0
    },
    {
      "name": "lockoutDuration",
      "type": "integer",
      "mode": "stored",
      "description": "Lockout duration in minutes",
      "default": 30,
      "min": 0
    },
    {
      "name": "isActive",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether this policy is active",
      "default": true
    },
    {
      "name": "appliesTo",
      "type": "string",
      "mode": "enum",
      "description": "Who this policy applies to",
      "enum": ["all", "organization", "role", "user_group"],
      "default": "all"
    },
    {
      "name": "createdAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "Creation timestamp",
      "required": true
    },
    {
      "name": "metadata",
      "type": "object",
      "mode": "stored",
      "description": "Additional metadata"
    }
  ],
  "examples": [
    {
      "@type": "PasswordPolicy",
      "name": "Strong Security Policy",
      "code": "STRONG",
      "minLength": 12,
      "maxLength": 128,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSpecialChars": true,
      "minUppercase": 2,
      "minLowercase": 2,
      "minNumbers": 2,
      "minSpecialChars": 2,
      "preventReuse": true,
      "reusePreventionCount": 10,
      "expirationDays": 60,
      "warningDays": 14,
      "preventCommonPasswords": true,
      "preventPersonalInfo": true,
      "lockoutAttempts": 3,
      "lockoutDuration": 60,
      "isActive": true,
      "appliesTo": "all",
      "createdAt": "2024-01-01T00:00:00Z"
    }
  ]
}
