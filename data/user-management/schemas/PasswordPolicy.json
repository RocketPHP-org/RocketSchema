{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "PasswordPolicy",
  "description": "Defines the rules and requirements for user passwords to ensure account security. This entity allows organizations to enforce their security standards by setting minimum password complexity requirements, expiration rules, and usage restrictions. Password policies can vary by user group - for example, administrators might need stronger passwords than regular users. The policy checks for common weaknesses like dictionary words, sequential characters, or passwords that are too similar to the username. It can enforce regular password changes, prevent reuse of recent passwords, and require specific character combinations (uppercase, lowercase, numbers, symbols). The entity also defines account lockout rules after failed attempts and can integrate with external password breach databases to prevent use of compromised passwords. This is crucial for meeting security compliance requirements like PCI DSS, HIPAA, or SOC 2, which often mandate specific password policies.",
  "properties": [
    {
      "name": "name",
      "type": "string",
      "mode": "stored",
      "description": "Unique name identifying this password policy",
      "required": true,
      "unique": true,
      "example": "Standard Security Policy"
    },
    {
      "name": "description",
      "type": "string",
      "mode": "stored",
      "description": "Explanation of when and why this policy is used",
      "example": "Default password policy for all regular user accounts"
    },
    {
      "name": "minLength",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum number of characters required",
      "default": 8,
      "min": 4,
      "example": 12
    },
    {
      "name": "maxLength",
      "type": "integer",
      "mode": "stored",
      "description": "Maximum number of characters allowed",
      "default": 128,
      "max": 256,
      "example": 64
    },
    {
      "name": "requireUppercase",
      "type": "boolean",
      "mode": "stored",
      "description": "Must include at least one uppercase letter (A-Z)",
      "default": true
    },
    {
      "name": "requireLowercase",
      "type": "boolean",
      "mode": "stored",
      "description": "Must include at least one lowercase letter (a-z)",
      "default": true
    },
    {
      "name": "requireNumbers",
      "type": "boolean",
      "mode": "stored",
      "description": "Must include at least one numeric digit (0-9)",
      "default": true
    },
    {
      "name": "requireSpecialChars",
      "type": "boolean",
      "mode": "stored",
      "description": "Must include at least one special character (!@#$%^&*)",
      "default": true
    },
    {
      "name": "specialCharsSet",
      "type": "string",
      "mode": "stored",
      "description": "Allowed special characters for passwords",
      "default": "!@#$%^&*()_+-=[]{}|;:,.<>?",
      "example": "!@#$%^&*"
    },
    {
      "name": "minUniqueChars",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum number of different characters required",
      "default": 4,
      "example": 5
    },
    {
      "name": "prohibitCommonPasswords",
      "type": "boolean",
      "mode": "stored",
      "description": "Check against list of commonly used weak passwords",
      "default": true
    },
    {
      "name": "prohibitUserInfo",
      "type": "boolean",
      "mode": "stored",
      "description": "Password cannot contain username, email, or name",
      "default": true
    },
    {
      "name": "prohibitRepeatingChars",
      "type": "integer",
      "mode": "stored",
      "description": "Maximum allowed consecutive identical characters",
      "default": 3,
      "example": 2
    },
    {
      "name": "prohibitSequentialChars",
      "type": "boolean",
      "mode": "stored",
      "description": "Prevent sequential characters like 'abc' or '123'",
      "default": true
    },
    {
      "name": "expirationDays",
      "type": "integer",
      "mode": "stored",
      "description": "Days until password expires (0 for no expiration)",
      "default": 90,
      "example": 60
    },
    {
      "name": "expirationWarningDays",
      "type": "integer",
      "mode": "stored",
      "description": "Days before expiration to start warning user",
      "default": 14,
      "example": 7
    },
    {
      "name": "passwordHistoryCount",
      "type": "integer",
      "mode": "stored",
      "description": "Number of previous passwords that cannot be reused",
      "default": 5,
      "example": 12
    },
    {
      "name": "minPasswordAge",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum days before password can be changed again",
      "default": 1,
      "example": 0
    },
    {
      "name": "maxLoginAttempts",
      "type": "integer",
      "mode": "stored",
      "description": "Failed attempts before account lockout",
      "default": 5,
      "example": 3
    },
    {
      "name": "lockoutDuration",
      "type": "integer",
      "mode": "stored",
      "description": "Minutes account remains locked after max attempts",
      "default": 30,
      "example": 60
    },
    {
      "name": "requireMfaOnReset",
      "type": "boolean",
      "mode": "stored",
      "description": "Require two-factor authentication when resetting password",
      "default": false
    },
    {
      "name": "checkPwnedPasswords",
      "type": "boolean",
      "mode": "stored",
      "description": "Check if password appears in breach databases",
      "default": true
    },
    {
      "name": "customRegex",
      "type": "string",
      "mode": "stored",
      "description": "Additional regex pattern password must match"
    },
    {
      "name": "isActive",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether this policy is currently enforced",
      "default": true
    },
    {
      "name": "priority",
      "type": "integer",
      "mode": "stored",
      "description": "Order of precedence when multiple policies apply",
      "default": 0
    }
  ],
  "examples": [
    {
      "@type": "PasswordPolicy",
      "name": "High Security Policy",
      "description": "Enhanced security policy for administrator and privileged accounts",
      "minLength": 14,
      "maxLength": 128,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSpecialChars": true,
      "specialCharsSet": "!@#$%^&*()_+-=[]{}|;:,.<>?",
      "minUniqueChars": 8,
      "prohibitCommonPasswords": true,
      "prohibitUserInfo": true,
      "prohibitRepeatingChars": 2,
      "prohibitSequentialChars": true,
      "expirationDays": 30,
      "expirationWarningDays": 7,
      "passwordHistoryCount": 24,
      "minPasswordAge": 1,
      "maxLoginAttempts": 3,
      "lockoutDuration": 60,
      "requireMfaOnReset": true,
      "checkPwnedPasswords": true,
      "customRegex": "^(?!.*\\s).*$",
      "isActive": true,
      "priority": 100
    },
    {
      "@type": "PasswordPolicy",
      "name": "Basic User Policy",
      "description": "Standard password requirements for regular user accounts",
      "minLength": 8,
      "maxLength": 64,
      "requireUppercase": true,
      "requireLowercase": true,
      "requireNumbers": true,
      "requireSpecialChars": false,
      "minUniqueChars": 5,
      "prohibitCommonPasswords": true,
      "prohibitUserInfo": true,
      "prohibitRepeatingChars": 3,
      "prohibitSequentialChars": false,
      "expirationDays": 0,
      "expirationWarningDays": 0,
      "passwordHistoryCount": 3,
      "minPasswordAge": 0,
      "maxLoginAttempts": 5,
      "lockoutDuration": 15,
      "requireMfaOnReset": false,
      "checkPwnedPasswords": true,
      "isActive": true,
      "priority": 50
    }
  ]
}