{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "OAuthProvider",
  "description": "Represents an external authentication provider configuration that enables delegated authentication flows. This entity manages the technical integration points and security credentials required to establish trust relationships with third-party identity providers, allowing end-users to authenticate using credentials managed by external systems rather than creating separate credentials. The provider configuration includes protocol-specific endpoints, client credentials, permission scopes, and flow control settings. Common use cases span social authentication flows where users leverage existing accounts from public identity providers, enterprise single sign-on scenarios where organizations centralize authentication through corporate identity systems, federated identity architectures connecting multiple autonomous systems, partner integrations requiring secure cross-boundary authentication, and multi-tenant platforms supporting customer-specific identity providers. The entity supports multiple authentication protocols including OAuth 2.0, OpenID Connect, SAML, and directory services, enabling organizations to offer flexible authentication options while maintaining security and user experience standards across diverse integration requirements.",
  "properties": [
    {
      "name": "identifier",
      "type": "string",
      "mode": "stored",
      "description": "Unique machine-readable identifier for the authentication provider configuration, used internally for routing and referencing",
      "required": true,
      "unique": true,
      "example": "enterprise-sso-primary"
    },
    {
      "name": "label",
      "type": "string",
      "mode": "stored",
      "description": "Human-readable name for the authentication provider displayed in user interfaces and administrative tools",
      "required": true,
      "example": "Enterprise Authentication"
    },
    {
      "name": "protocolType",
      "type": "string",
      "mode": "enum",
      "description": "Authentication protocol used by the provider for credential exchange and identity verification",
      "enum": [
        "oauth2",
        "oidc",
        "saml2",
        "ldap",
        "custom"
      ],
      "required": true,
      "example": "oidc"
    },
    {
      "name": "clientIdentifier",
      "type": "string",
      "mode": "stored",
      "description": "Application identifier registered with the authentication provider, uniquely identifying this client in provider's system",
      "required": true,
      "example": "app-f47ac10b-58cc-4372-a567-0e02b2c3d479"
    },
    {
      "name": "clientCredential",
      "type": "string",
      "mode": "stored",
      "description": "Secret credential used to authenticate this application with the provider, must be encrypted at rest and never exposed in client-side code",
      "required": true,
      "private": true
    },
    {
      "name": "authorizationEndpoint",
      "type": "string",
      "mode": "stored",
      "description": "URL where users are redirected to initiate the authentication flow and grant permissions to the requesting application",
      "required": true,
      "format": "uri",
      "example": "https://auth.provider.example/protocol/authorize"
    },
    {
      "name": "tokenEndpoint",
      "type": "string",
      "mode": "stored",
      "description": "URL used for server-to-server communication to exchange authorization codes for access tokens and refresh expired tokens",
      "required": true,
      "format": "uri",
      "example": "https://auth.provider.example/protocol/token"
    },
    {
      "name": "userInfoEndpoint",
      "type": "string",
      "mode": "stored",
      "description": "URL to retrieve authenticated user profile information and claims after successful authentication",
      "nullable": true,
      "format": "uri",
      "example": "https://auth.provider.example/protocol/userinfo"
    },
    {
      "name": "discoveryEndpoint",
      "type": "string",
      "mode": "stored",
      "description": "URL providing provider metadata and configuration details, commonly used in OpenID Connect for automatic endpoint discovery",
      "nullable": true,
      "format": "uri",
      "example": "https://auth.provider.example/.well-known/openid-configuration"
    },
    {
      "name": "requestedScopes",
      "type": "string[]",
      "mode": "stored",
      "description": "List of permission scopes requested from the provider, defining what user data and capabilities the application can access",
      "example": [
        "openid",
        "email",
        "profile"
      ]
    },
    {
      "name": "callbackEndpoint",
      "type": "string",
      "mode": "stored",
      "description": "URL where the provider redirects users after authentication, must be registered with the provider to prevent redirect attacks",
      "required": true,
      "format": "uri",
      "example": "https://application.example/auth/callback"
    },
    {
      "name": "enabled",
      "type": "boolean",
      "mode": "stored",
      "description": "Controls whether this provider is currently available for authentication flows, allowing temporary disabling without deletion",
      "default": true
    },
    {
      "name": "defaultProvider",
      "type": "boolean",
      "mode": "stored",
      "description": "Indicates whether this provider should be presented as the primary authentication option in user interfaces",
      "default": false
    },
    {
      "name": "allowAccountCreation",
      "type": "boolean",
      "mode": "stored",
      "description": "Determines whether successful authentication from unknown users should automatically create new accounts in the system",
      "default": true
    },
    {
      "name": "automaticAccountAssociation",
      "type": "boolean",
      "mode": "stored",
      "description": "Controls whether accounts should be automatically linked when matching identity attributes are detected across providers",
      "default": false
    },
    {
      "name": "associationAttributeName",
      "type": "string",
      "mode": "stored",
      "description": "Name of the user attribute used for automatic account association when automaticAccountAssociation is enabled",
      "nullable": true,
      "example": "email"
    },
    {
      "name": "tokenExpirationSeconds",
      "type": "integer",
      "mode": "stored",
      "description": "Default lifetime in seconds for access tokens issued by this provider, used for token refresh logic",
      "nullable": true,
      "example": 3600
    },
    {
      "name": "supportsPKCE",
      "type": "boolean",
      "mode": "stored",
      "description": "Indicates whether the provider supports Proof Key for Code Exchange extension for enhanced security in authorization code flows",
      "default": false
    },
    {
      "name": "requiresState",
      "type": "boolean",
      "mode": "stored",
      "description": "Controls whether state parameter must be included in authorization requests to prevent cross-site request forgery attacks",
      "default": true
    },
    {
      "name": "displayOrder",
      "type": "integer",
      "mode": "stored",
      "description": "Numeric value determining the relative position of this provider when multiple options are presented to users",
      "nullable": true,
      "example": 1
    }
  ],
  "examples": [
    {
      "@type": "OAuthProvider",
      "identifier": "social-auth-primary",
      "label": "Social Authentication",
      "protocolType": "oauth2",
      "clientIdentifier": "app-1234567890abcdef",
      "authorizationEndpoint": "https://identity.socialprovider.example/oauth2/authorize",
      "tokenEndpoint": "https://identity.socialprovider.example/oauth2/token",
      "userInfoEndpoint": "https://identity.socialprovider.example/oauth2/userinfo",
      "requestedScopes": [
        "openid",
        "email",
        "profile"
      ],
      "callbackEndpoint": "https://myapplication.example/auth/social/callback",
      "enabled": true,
      "defaultProvider": true,
      "allowAccountCreation": true,
      "automaticAccountAssociation": true,
      "associationAttributeName": "email",
      "tokenExpirationSeconds": 3600,
      "supportsPKCE": true,
      "requiresState": true,
      "displayOrder": 1
    },
    {
      "@type": "OAuthProvider",
      "identifier": "enterprise-sso-main",
      "label": "Corporate Identity System",
      "protocolType": "oidc",
      "clientIdentifier": "client-98765432-wxyz-abcd-efgh-fedcba987654",
      "authorizationEndpoint": "https://directory.enterprise.example/auth/protocol/openid-connect/auth",
      "tokenEndpoint": "https://directory.enterprise.example/auth/protocol/openid-connect/token",
      "userInfoEndpoint": "https://directory.enterprise.example/auth/protocol/openid-connect/userinfo",
      "discoveryEndpoint": "https://directory.enterprise.example/auth/.well-known/openid-configuration",
      "requestedScopes": [
        "openid",
        "email",
        "profile",
        "groups"
      ],
      "callbackEndpoint": "https://intranet.company.example/auth/enterprise/callback",
      "enabled": true,
      "defaultProvider": false,
      "allowAccountCreation": false,
      "automaticAccountAssociation": false,
      "tokenExpirationSeconds": 7200,
      "supportsPKCE": true,
      "requiresState": true,
      "displayOrder": 2
    },
    {
      "@type": "OAuthProvider",
      "identifier": "partner-federation",
      "label": "Partner Authentication Bridge",
      "protocolType": "saml2",
      "clientIdentifier": "sp-entity-f47ac10b-58cc-4372-a567-0e02b2c3d479",
      "authorizationEndpoint": "https://federation.partner.example/saml2/sso",
      "tokenEndpoint": "https://federation.partner.example/saml2/token",
      "callbackEndpoint": "https://platform.example/auth/partner/callback",
      "enabled": true,
      "defaultProvider": false,
      "allowAccountCreation": true,
      "automaticAccountAssociation": true,
      "associationAttributeName": "federatedIdentifier",
      "requiresState": true,
      "displayOrder": 3
    }
  ]
}
