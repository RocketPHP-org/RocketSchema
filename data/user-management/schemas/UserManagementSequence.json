{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "UserManagementSequence",
  "description": "Provides atomic sequence generation for creating unique identifiers across the user management system, ensuring no duplicates even under high concurrency. This entity implements database sequences at the application level, critical for generating unique values like user IDs, session tokens, or invoice numbers in distributed systems where auto-increment fields aren't reliable. Each sequence maintains a current value and increment step, with atomic operations guaranteeing that no two requests get the same value even when thousands of requests arrive simultaneously. The entity supports different sequence strategies: monotonic increasing (like traditional auto-increment), cyclic (wrapping around after reaching max value), and cached sequences for performance (pre-allocating blocks of numbers). Caching is particularly important for high-throughput systems - instead of hitting the database for every ID, the application can reserve a block of 100 IDs and distribute them from memory. This entity also handles overflow scenarios, supports custom formatting (like adding prefixes or padding), and maintains audit information about sequence usage. It's essential for maintaining referential integrity and ensuring unique constraints are never violated, especially in systems that need to generate IDs across multiple application servers or during database migrations.",
  "properties": [
    {
      "name": "sequenceName",
      "type": "string",
      "mode": "stored",
      "description": "Unique identifier for this sequence",
      "required": true,
      "unique": true,
      "example": "user_id_sequence"
    },
    {
      "name": "currentValue",
      "type": "bigint",
      "mode": "stored",
      "description": "Current value of the sequence",
      "required": true,
      "default": 0
    },
    {
      "name": "incrementBy",
      "type": "integer",
      "mode": "stored",
      "description": "Value to add for each sequence increment",
      "default": 1
    },
    {
      "name": "minValue",
      "type": "bigint",
      "mode": "stored",
      "description": "Minimum allowed value for the sequence",
      "default": 0
    },
    {
      "name": "maxValue",
      "type": "bigint",
      "mode": "stored",
      "description": "Maximum allowed value before cycling or error",
      "default": 9223372036854775807
    },
    {
      "name": "startValue",
      "type": "bigint",
      "mode": "stored",
      "description": "Initial value when sequence was created",
      "default": 0
    },
    {
      "name": "isCyclic",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether to wrap around to minValue after reaching maxValue",
      "default": false
    },
    {
      "name": "cacheSize",
      "type": "integer",
      "mode": "stored",
      "description": "Number of values to pre-allocate for performance",
      "default": 10
    },
    {
      "name": "cachedUntil",
      "type": "bigint",
      "mode": "stored",
      "description": "Last value in the current cache block",
      "nullable": true
    },
    {
      "name": "prefix",
      "type": "string",
      "mode": "stored",
      "description": "String prefix to add to generated values",
      "nullable": true,
      "example": "USR"
    },
    {
      "name": "suffix",
      "type": "string",
      "mode": "stored",
      "description": "String suffix to add to generated values",
      "nullable": true
    },
    {
      "name": "paddingLength",
      "type": "integer",
      "mode": "stored",
      "description": "Minimum length with zero padding",
      "default": 0,
      "example": 10
    },
    {
      "name": "format",
      "type": "string",
      "mode": "stored",
      "description": "Format pattern for generated values",
      "nullable": true,
      "example": "USR-{YYYY}-{######}"
    },
    {
      "name": "lastAllocatedAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "When a value was last allocated from this sequence",
      "nullable": true
    },
    {
      "name": "allocationCount",
      "type": "bigint",
      "mode": "stored",
      "description": "Total number of values allocated",
      "default": 0
    },
    {
      "name": "lastResetAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "When the sequence was last reset",
      "nullable": true
    },
    {
      "name": "isLocked",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether the sequence is locked for maintenance",
      "default": false
    },
    {
      "name": "description",
      "type": "string",
      "mode": "stored",
      "description": "Purpose and usage notes for this sequence",
      "nullable": true
    },
    {
      "name": "lastModifiedAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "Last time the sequence configuration changed",
      "required": true
    },
    {
      "name": "version",
      "type": "integer",
      "mode": "stored",
      "description": "Version for optimistic locking on updates",
      "default": 1
    }
  ],
  "examples": [
    {
      "@type": "UserManagementSequence",
      "sequenceName": "user_id_sequence",
      "currentValue": 1547823,
      "incrementBy": 1,
      "minValue": 1000000,
      "maxValue": 9999999,
      "startValue": 1000000,
      "isCyclic": false,
      "cacheSize": 100,
      "cachedUntil": 1547923,
      "prefix": "USR",
      "paddingLength": 7,
      "format": "USR{#######}",
      "lastAllocatedAt": "2024-03-15T14:30:45Z",
      "allocationCount": 547823,
      "isLocked": false,
      "description": "Main sequence for generating unique user IDs",
      "lastModifiedAt": "2024-01-01T00:00:00Z",
      "version": 5478
    },
    {
      "@type": "UserManagementSequence",
      "sequenceName": "session_token_counter",
      "currentValue": 9999887,
      "incrementBy": 1,
      "minValue": 0,
      "maxValue": 9999999,
      "startValue": 0,
      "isCyclic": true,
      "cacheSize": 1000,
      "cachedUntil": 9999999,
      "paddingLength": 7,
      "lastAllocatedAt": "2024-03-15T14:31:00Z",
      "allocationCount": 85643219,
      "lastResetAt": "2024-03-15T00:00:00Z",
      "isLocked": false,
      "description": "Cyclic counter for session token generation, resets daily",
      "lastModifiedAt": "2024-03-15T00:00:00Z",
      "version": 856
    }
  ]
}
