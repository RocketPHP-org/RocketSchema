{
  "@type": "Schema",
  "@context": "https://rocketschema.org/context",
  "name": "ApiKeyAllowedOrigin",
  "description": "Manages Cross-Origin Resource Sharing (CORS) settings for API keys used in web browsers. When JavaScript running on a website tries to call your API, browsers enforce the same-origin policy for security - requests are blocked unless explicitly allowed. This entity defines which websites can use each API key from browser-based JavaScript, preventing unauthorized sites from making API calls even if they somehow obtain a valid key. Each origin entry includes the protocol, domain, and port (like https://app.example.com) that's permitted to use the API key. The entity also configures which HTTP methods are allowed, what headers can be sent, and how long browsers should cache these permissions. This is critical for public API keys that are embedded in client-side code, as they're visible to anyone viewing the page source. By restricting origins, you ensure that even exposed keys can only be used from your authorized domains. The system can allow all subdomains with a single rule, making it easier to manage multi-tenant applications. CORS preflight responses use this data to tell browsers whether to allow the actual API request.",
  "properties": [
    {
      "name": "apiKey",
      "type": "ApiKey",
      "mode": "stored",
      "description": "The API key these CORS settings apply to",
      "required": true
    },
    {
      "name": "origin",
      "type": "string",
      "mode": "stored",
      "description": "Allowed origin URL including protocol and port",
      "required": true,
      "example": "https://app.example.com"
    },
    {
      "name": "allowSubdomains",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether all subdomains of this origin are allowed",
      "default": false
    },
    {
      "name": "allowedMethods",
      "type": "string",
      "mode": "stored",
      "description": "Comma-separated list of allowed HTTP methods",
      "default": "GET,POST",
      "example": "GET,POST,PUT,DELETE,PATCH"
    },
    {
      "name": "allowedHeaders",
      "type": "string",
      "mode": "stored",
      "description": "Comma-separated list of allowed request headers",
      "nullable": true,
      "example": "Content-Type,Authorization,X-Requested-With"
    },
    {
      "name": "exposedHeaders",
      "type": "string",
      "mode": "stored",
      "description": "Headers that browsers can access in the response",
      "nullable": true,
      "example": "X-Total-Count,X-Page-Number"
    },
    {
      "name": "allowCredentials",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether cookies and auth headers can be included",
      "default": false
    },
    {
      "name": "maxAge",
      "type": "integer",
      "mode": "stored",
      "description": "Seconds browsers should cache preflight responses",
      "default": 3600,
      "example": 86400
    },
    {
      "name": "description",
      "type": "string",
      "mode": "stored",
      "description": "Note about why this origin is allowed",
      "nullable": true
    },
    {
      "name": "environment",
      "type": "string",
      "mode": "enum",
      "description": "Which environment this origin is for",
      "enum": [
        "development",
        "staging",
        "production",
        "all"
      ],
      "default": "production"
    },
    {
      "name": "addedAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "When this origin was authorized",
      "required": true
    },
    {
      "name": "lastUsedAt",
      "type": "DateTime",
      "mode": "stored",
      "description": "Last time a request came from this origin",
      "nullable": true
    },
    {
      "name": "requestCount",
      "type": "integer",
      "mode": "stored",
      "description": "Number of requests from this origin",
      "default": 0
    },
    {
      "name": "isActive",
      "type": "boolean",
      "mode": "stored",
      "description": "Whether this origin is currently allowed",
      "default": true
    }
  ],
  "examples": [
    {
      "@type": "ApiKeyAllowedOrigin",
      "origin": "https://www.myapp.com",
      "allowSubdomains": true,
      "allowedMethods": "GET,POST,PUT,DELETE",
      "allowedHeaders": "Content-Type,Authorization,X-API-Key",
      "exposedHeaders": "X-RateLimit-Remaining,X-RateLimit-Reset",
      "allowCredentials": true,
      "maxAge": 86400,
      "description": "Main production website and all subdomains",
      "environment": "production",
      "addedAt": "2024-01-01T00:00:00Z",
      "lastUsedAt": "2024-03-15T14:30:00Z",
      "requestCount": 1847293,
      "isActive": true,
      "apiKey": "key_public_123"
    },
    {
      "@type": "ApiKeyAllowedOrigin",
      "origin": "http://localhost:3000",
      "allowSubdomains": false,
      "allowedMethods": "GET,POST",
      "allowedHeaders": "Content-Type",
      "allowCredentials": false,
      "maxAge": 300,
      "description": "Local development environment for React app",
      "environment": "development",
      "addedAt": "2024-02-15T10:00:00Z",
      "lastUsedAt": "2024-03-15T16:45:00Z",
      "requestCount": 8234,
      "isActive": true,
      "apiKey": "key_dev_456"
    }
  ]
}